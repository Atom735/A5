# A5

## Список целей

- [x] Открыть файл
- [x] Считать данные в буффер
- [x] Разбить данные на токены
- [ ] Подсчитать линии и создать массив указателей на первые токены в линиях
- [ ] Создать класс окна
- [ ] Создать окно
- [ ] Отобразить все токены
- [ ] Добавить обработчик ошибок

# A5 Text Viewer

## v0.190210

- Используется свой класс окон `WCN-A5-TextViewer`
- Название окна является путем открытого файла в __UTF-16__. Названия начинающиеся с символа `*` (звёздочка) будут использованы для показа внутренних данных.
- Данные открытых файлов преобразуются в кодировку __UTF-16__ и хранятся в буффере, который связан с окном.
- Данные о строках файлах будут храниться также в буффере связанном с окном. И иметь следующую приблезительную структуру:
```C
    UINT nCount; // Количество строк
    struct {
        UINT nOffset; // Смещение начала строки
        UINT nSize; // Длина строки
    } data[nCount];
```
- Отображение идёт по строкам с помощью функций __GDI__, а в частности `TextOutW`.

### Расчётное потребление памяти
- _1n_ или _2n_ под буффер самого файла
- _2n_ * `sizeof(UINT)`
- __Итого:__ порядка _10n_ байт

# A5 Word Book

У нас есть словарь, в который мы можем добавлять различные массивы данных, искать совпадения. Каждому элементу словаря соответсвует уникальный айди. По уникальному айди можно получить информацию о слове.

ключ -> таблица данных ключей -> смещение, длина и флаги -> датабаза

## Пример

### Таблица ключей

| N | Смещение | Размер            | Флаги | Данные в базе |
|---|----------|-------------------|-------|---------------|
| 0 | _UNDEF_  | n - кол-во ключей | HEAD  | _UNDEF_       |
| 1 | 4        | 5                 | STR   | `Hello`       |
| 2 | 28       | 5                 | STR   | `World`       |
| 3 | 0        | 2                 | PUNCT | `/*`          |
| 4 | 2        | 2                 | PUNCT | `*/`          |
| 5 | 10       | 12                | WSTR  | `Привет`      |
| 6 | 22       | 6                 | WSTR  | `Мир`         |


При этом сами данные в базе значений будет выглядеть как:
`/**/Hello~П р и в е т М и р World`
Где знак `~` - неопределённый байт... Так как использовалось выравнивание для слова `Привет`, а пробелы означают второй байт, так как широкие символы занимают по два байта.


